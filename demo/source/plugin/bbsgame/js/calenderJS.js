function HS_DateAdd(a,b,c){b=parseInt(b);if(typeof c=="string")var c=new Date(c.split("-")[0],c.split("-")[1],c.split("-")[2]);if(typeof c=="object")var c=c;switch(a){case"y":return new Date(c.getFullYear()+b,c.getMonth(),c.getDate());case"m":return new Date(c.getFullYear(),c.getMonth()+b,checkDate(c.getFullYear(),c.getMonth()+b,c.getDate()));case"d":return new Date(c.getFullYear(),c.getMonth(),c.getDate()+b);case"w":return new Date(c.getFullYear(),c.getMonth(),7*b+c.getDate())}}function checkDate(a,b,c){var d=["31","28","31","30","31","30","31","31","30","31","30","31"],e="";return a%4==0&&(d[1]="29"),c>d[b]?e=d[b]:e=c,e}function WeekDay(a){var b;return typeof a=="string"&&(b=new Date(a.split("-")[0],a.split("-")[1],a.split("-")[2])),typeof a=="object"&&(b=a),b.getDay()}function HS_calender(){var a="",b="";b+="<style type='text/css'>",b+=".calender { width:170px; height:auto; font-size:12px; margin-right:14px; background:#fff; border:1px solid #397EAE; padding:1px}",b+=".calender ul {list-style-type:none; margin:0; padding:0;}",b+=".calender .day { background-color:#EDF5FF; height:20px;}",b+=".calender .day li,.calender .date li{ float:left; width:14%; height:20px; line-height:20px; text-align:center}",b+=".calender li a { text-decoration:none; font-family:Tahoma; font-size:11px; color:#333}",b+=".calender li a:hover { color:#f30; text-decoration:underline}",b+=".calender li a.hasArticle {font-weight:bold; color:#f60 !important}",b+=".lastMonthDate, .nextMonthDate {color:#bbb;font-size:11px}",b+=".selectThisYear a, .selectThisMonth a{text-decoration:none; margin:0 2px; color:#000; font-weight:bold}",b+=".calender .LastMonth, .calender .NextMonth{ text-decoration:none; color:#000; font-size:18px; font-weight:bold; line-height:16px;}",b+=".calender .LastMonth { float:left;}",b+=".calender .NextMonth { float:right;}",b+=".calenderBody {clear:both}",b+=".calenderTitle {text-align:center;height:20px; line-height:20px; clear:both}",b+=".today { background-color:#ffffaa;border:1px solid #f60; padding:2px}",b+=".today a { color:#f30; }",b+=".calenderBottom {clear:both; border-top:1px solid #ddd; padding: 3px 0; text-align:left}",b+=".calenderBottom a {text-decoration:none; margin:2px !important; font-weight:bold; color:#000}",b+=".calenderBottom a.closeCalender{float:right}",b+=".closeCalenderBox {float:right; border:1px solid #000; background:#fff; font-size:9px; width:11px; height:11px; line-height:11px; text-align:center;overflow:hidden; font-weight:normal !important}",b+="</style>";var c;if(typeof arguments[0]=="string"){selectDate=arguments[0].split("-");var d=selectDate[0],e=parseInt(selectDate[1])-1+"",f=selectDate[2];c=new Date(d,e,f)}else typeof arguments[0]=="object"&&(c=arguments[0]);var g=HS_DateAdd("d","-1",c.getFullYear()+"-"+c.getMonth()+"-01").getDate(),h=WeekDay(c.getFullYear()+"-"+c.getMonth()+"-01"),j=HS_DateAdd("d","-1",c.getFullYear()+"-"+(parseInt(c.getMonth())+1).toString()+"-01"),k=j.getDate(),l=j.getDay(),m=new Date;today=m.getFullYear()+"-"+m.getMonth()+"-"+m.getDate();for(i=0;i<h;i++)a="<li class='lastMonthDate'>"+g+"</li>"+a,g--;for(i=1;i<=k;i++)if(today==c.getFullYear()+"-"+c.getMonth()+"-"+i){var n=c.getFullYear()+"-"+(parseInt(c.getMonth())+1).toString()+"-"+i;a+="<li><a href=javascript:void(0) class='today' onclick='_selectThisDay(this)' title='"+c.getFullYear()+"-"+(parseInt(c.getMonth())+1)+"-"+i+"'>"+i+"</a></li>"}else a+="<li><a href=javascript:void(0) onclick='_selectThisDay(this)' title='"+c.getFullYear()+"-"+(parseInt(c.getMonth())+1)+"-"+i+"'>"+i+"</a></li>";var o=1;for(i=l;i<6;i++)a+="<li class='nextMonthDate'>"+o+"</li>",o++;a+=b;var p="<a href='javascript:void(0)' class='NextMonth' onclick=HS_calender(HS_DateAdd('m',1,'"+c.getFullYear()+"-"+c.getMonth()+"-"+c.getDate()+"'),this) title='Next Month'>&raquo;</a>";p+="<a href='javascript:void(0)' class='LastMonth' onclick=HS_calender(HS_DateAdd('m',-1,'"+c.getFullYear()+"-"+c.getMonth()+"-"+c.getDate()+"'),this) title='Previous Month'>&laquo;</a>",p+="<span class='selectThisYear'><a href='javascript:void(0)' onclick='CalenderselectYear(this)' title='Click here to select other year' >"+c.getFullYear()+"</a></span>\u5e74<span class='selectThisMonth'><a href='javascript:void(0)' onclick='CalenderselectMonth(this)' title='Click here to select other month'>"+(parseInt(c.getMonth())+1).toString()+"</a></span>\u6708";if(arguments.length>1)arguments[1].parentNode.parentNode.getElementsByTagName("ul")[1].innerHTML=a,arguments[1].parentNode.innerHTML=p;else{var q=b+"<div class='calender'><div class='calenderTitle'>"+p+"</div><div class='calenderBody'><ul class='day'><li>\u65e5</li><li>\u4e00</li><li>\u4e8c</li><li>\u4e09</li><li>\u56db</li><li>\u4e94</li><li>\u516d</li></ul><ul class='date' id='thisMonthDate'>"+a+"</ul></div><div class='calenderBottom'><a href='javascript:void(0)' class='closeCalender' onclick='closeCalender(this)'>&times;</a><span><span><a href=javascript:void(0) onclick='_selectThisDay(this)' title='"+n+"'>Today</a></span></span></div></div>";return q}}function _selectThisDay(a){var b=a.parentNode.parentNode.parentNode.parentNode.parentNode;b.targetObj.value=a.title,b.parentNode.removeChild(b)}function closeCalender(a){var b=a.parentNode.parentNode.parentNode;b.parentNode.removeChild(b)}function CalenderselectYear(a){var b="",c=a.innerHTML;for(i=1970;i<=2020;i++)i==c?b+="<option value="+i+" selected>"+i+"</option>":b+="<option value="+i+">"+i+"</option>";b="<select onblur='selectThisYear(this)' onchange='selectThisYear(this)' style='font-size:11px'>"+b+"</select>",a.parentNode.innerHTML=b}function selectThisYear(a){HS_calender(a.value+"-"+a.parentNode.parentNode.getElementsByTagName("span")[1].getElementsByTagName("a")[0].innerHTML+"-1",a.parentNode)}function CalenderselectMonth(a){var b="",c=a.innerHTML;for(i=1;i<=12;i++)i==c?b+="<option value="+i+" selected>"+i+"</option>":b+="<option value="+i+">"+i+"</option>";b="<select onblur='selectThisMonth(this)' onchange='selectThisMonth(this)' style='font-size:11px'>"+b+"</select>",a.parentNode.innerHTML=b}function selectThisMonth(a){HS_calender(a.parentNode.parentNode.getElementsByTagName("span")[0].getElementsByTagName("a")[0].innerHTML+"-"+a.value+"-1",a.parentNode)}function HS_setDate(a){var b=document.createElement("span");b.innerHTML=HS_calender(new Date),b.style.position="absolute",b.targetObj=a,a.parentNode.insertBefore(b,a.nextSibling)}